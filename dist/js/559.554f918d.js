"use strict";(self["webpackChunkxlzx"]=self["webpackChunkxlzx"]||[]).push([[559],{79559(e,r,o){o.r(r),o.d(r,{default:()=>U});var n=o(59258),u=o(61832),t=o(78258),s=o(24232),a={class:"login-wrap"},i={class:"login-container"},c={class:"form-group"},l={key:0,class:"error-text"},d={class:"form-group"},p={key:0,class:"error-text"},b={class:"form-group"},m={class:"input-with-btn"},f={key:0,class:"error-text"},h={class:"form-group"},v=["value"],N=["disabled"],E={key:0},k={key:1};function g(e,r,o,g,L,j){return(0,u.uX)(),(0,u.CE)("div",a,[(0,u.Lk)("div",i,[r[30]||(r[30]=(0,u.Lk)("div",{class:"logo-area"},[(0,u.Lk)("div",{class:"logo-icon"},[(0,u.Lk)("i",{class:"fa fa-graduation-cap"})]),(0,u.Lk)("p",{class:"title"},"师资风采大赛-初赛"),(0,u.Lk)("h2",null,"请用企微真实信息-登录")],-1)),(0,u.Lk)("form",{class:"form-content",onSubmit:r[20]||(r[20]=(0,t.D$)(function(){return g.handleLogin&&g.handleLogin.apply(g,arguments)},["prevent"]))},[(0,u.Lk)("div",c,[(0,u.Lk)("div",{class:(0,s.C4)(["input-wrapper",{focused:e.userNameFocused,error:e.userNameError}])},[r[21]||(r[21]=(0,u.Lk)("i",{class:"fa fa-user"},null,-1)),(0,u.bo)((0,u.Lk)("input",{type:"text",id:"userName","onUpdate:modelValue":r[0]||(r[0]=function(r){return e.userName=r}),placeholder:"您的真实姓名",required:"",onFocus:r[1]||(r[1]=function(r){return e.userNameFocused=!0}),onBlur:r[2]||(r[2]=function(r){e.userNameFocused=!1,g.validateUserName()}),onInput:r[3]||(r[3]=function(e){return g.validateUserName()})},null,544),[[t.Jo,e.userName]])],2),e.userNameError?((0,u.uX)(),(0,u.CE)("p",l,(0,s.v_)(e.userNameErrorMsg),1)):(0,u.Q3)("",!0)]),(0,u.Lk)("div",d,[(0,u.Lk)("div",{class:(0,s.C4)(["input-wrapper",{focused:e.jobNumberFocused,error:e.jobNumberError}])},[r[22]||(r[22]=(0,u.Lk)("i",{class:"fa fa-id-card"},null,-1)),(0,u.bo)((0,u.Lk)("input",{type:"text",id:"jobNumber","onUpdate:modelValue":r[4]||(r[4]=function(r){return e.jobNumber=r}),placeholder:"企微工号，6位数字，如085796",required:"",onFocus:r[5]||(r[5]=function(r){return e.jobNumberFocused=!0}),onBlur:r[6]||(r[6]=function(r){e.jobNumberFocused=!1,g.validateJobNumber()}),onInput:r[7]||(r[7]=function(e){return g.validateJobNumber()}),minlength:"6",maxlength:"6"},null,544),[[t.Jo,e.jobNumber]])],2),e.jobNumberError?((0,u.uX)(),(0,u.CE)("p",p,(0,s.v_)(e.jobNumberErrorMsg),1)):(0,u.Q3)("",!0)]),(0,u.Lk)("div",b,[(0,u.Lk)("div",m,[(0,u.Lk)("div",{class:(0,s.C4)(["input-wrapper",{focused:e.phoneFocused,error:e.phoneError}])},[r[23]||(r[23]=(0,u.Lk)("i",{class:"fa fa-phone"},null,-1)),(0,u.bo)((0,u.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":r[8]||(r[8]=function(r){return e.phone=r}),placeholder:"企微绑定的手机号",required:"",onFocus:r[9]||(r[9]=function(r){return e.phoneFocused=!0}),onBlur:r[10]||(r[10]=function(r){e.phoneFocused=!1,g.validatePhone()}),onInput:r[11]||(r[11]=function(e){return g.validatePhone()}),maxlength:"11"},null,544),[[t.Jo,e.phone]])],2)]),e.phoneError?((0,u.uX)(),(0,u.CE)("p",f,(0,s.v_)(e.phoneErrorMsg),1)):(0,u.Q3)("",!0)]),(0,u.Q3)("",!0),(0,u.Lk)("div",h,[(0,u.Lk)("div",{class:(0,s.C4)(["select-wrapper",{focused:e.isSelectFocused}])},[r[27]||(r[27]=(0,u.Lk)("i",{class:"fa fa-book"},null,-1)),(0,u.bo)((0,u.Lk)("select",{"onUpdate:modelValue":r[16]||(r[16]=function(r){return e.selectedSubject=r}),id:"subject",required:"",onFocus:r[17]||(r[17]=function(r){return e.isSelectFocused=!0}),onBlur:r[18]||(r[18]=function(r){return e.isSelectFocused=!1})},[r[26]||(r[26]=(0,u.Lk)("option",{value:"",disabled:"",selected:""},"请选择您所属的学科",-1)),((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(e.subjects,function(e){return(0,u.uX)(),(0,u.CE)("option",{value:e.id,key:e.id},(0,s.v_)(e.title),9,v)}),128))],544),[[t.u1,e.selectedSubject]]),r[28]||(r[28]=(0,u.Lk)("div",{class:"select-arrow"},[(0,u.Lk)("i",{class:"fa fa-chevron-down"})],-1))],2)]),(0,u.Lk)("button",{class:"login-btn",onClick:r[19]||(r[19]=function(){return g.handleLogin&&g.handleLogin.apply(g,arguments)}),disabled:e.isLoading},[e.isLoading?((0,u.uX)(),(0,u.CE)("span",k,(0,n.A)(r[29]||(r[29]=[(0,u.Lk)("i",{class:"fa fa-spinner fa-spin"},null,-1),(0,u.eW)(" 登录中...",-1)])))):((0,u.uX)(),(0,u.CE)("span",E,"登录"))],8,N)],32),r[31]||(r[31]=(0,u.Lk)("div",{class:"footer-text"},[(0,u.Lk)("p",{class:"action"},"© 2025 师资风采大赛-题目投票系统"),(0,u.Lk)("p",{class:"action"}," 为确保投票的公平，请用真实个人信息投票，非真实信息投票无效！ "),(0,u.Lk)("p",{class:"action"}," 系统使用过程中如有疑问请企微联系：基础研究总院-王伟 ")],-1))])])}var L=o(20908),j=o(41034),y=o(30388),C=(o(44114),o(2892),o(27495),o(90906),o(42762),o(76031),o(95816)),w=o(81387),F=o(14677),M=o(77726),S=o(80057);const A={name:"Login",setup:function(){var e=(0,w.rd)(),r=(0,S.Pj)(),o=(0,C.Kh)({userName:"",jobNumber:"",phone:"",verifyCode:"110000",selectedSubject:"",subjects:[],isLoading:!1,isSelectFocused:!1,userNameFocused:!1,jobNumberFocused:!1,phoneFocused:!1,verifyCodeFocused:!1,userNameError:!1,userNameErrorMsg:"",jobNumberError:!1,jobNumberErrorMsg:"",phoneError:!1,phoneErrorMsg:"",verifyCodeError:!0,verifyCodeErrorMsg:"",countdown:0,canSendCode:!0}),n=(0,C.KR)(!1);function t(){return s.apply(this,arguments)}function s(){return s=(0,y.A)((0,L.A)().m(function e(){var r,n;return(0,L.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,M.u7)();case 1:r=e.v,n=r.knowledgeTreeList,o.subjects=n||[],e.n=3;break;case 2:e.p=2,e.v,(0,F.y)("获取学科列表失败，请刷新页面重试");case 3:return e.a(2)}},e,null,[[0,2]])})),s.apply(this,arguments)}function a(){var e=o.userName.trim(),r=/^[\u4e00-\u9fa5·]{2,10}$/,n=/^·|·$|·{2,}/;return e&&(!r.test(e)||n.test(e))?(o.userNameError=!0,o.userNameErrorMsg="请输入2~10个汉字的真实姓名",d(),!1):(o.userNameError=!1,o.userNameErrorMsg="",d(),!0)}function i(){var e=o.jobNumber.trim(),r=/^\d{6}$/;return e?r.test(e)?Number(e)>9e4?(o.jobNumberError=!0,o.jobNumberErrorMsg="整输入正确的工号",d(),!1):(o.jobNumberError=!1,o.jobNumberErrorMsg="",d(),!0):(o.jobNumberError=!0,o.jobNumberErrorMsg="工号必须为0开头的6位数字",d(),!1):(o.jobNumberError=!1,o.jobNumberErrorMsg="",d(),!0)}function c(){var e=o.phone.trim(),r=/^1\d{10}$/;return e?r.test(e)?(o.phoneError=!1,o.phoneErrorMsg="",d(),!0):(o.phoneError=!0,o.phoneErrorMsg="请输入正确的11位手机号",d(),!1):(o.phoneError=!1,o.phoneErrorMsg="",d(),!0)}function l(){var e=o.verifyCode.trim(),r=/^\d{6}$/;return e?r.test(e)?(o.verifyCodeError=!1,o.verifyCodeErrorMsg="",d(),!0):(o.verifyCodeError=!0,o.verifyCodeErrorMsg="验证码必须为6位数字",d(),!1):(o.verifyCodeError=!1,o.verifyCodeErrorMsg="",d(),!0)}function d(){n.value=!o.userNameError&&!o.jobNumberError&&!o.phoneError&&o.userName.trim()&&o.jobNumber.trim()&&o.phone.trim()&&o.selectedSubject}function p(){return b.apply(this,arguments)}function b(){return b=(0,y.A)((0,L.A)().m(function e(){var r;return(0,L.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(c()&&!o.phoneError){e.n=1;break}return(0,F.y)("请输入正确的手机号"),e.a(2);case 1:return o.canSendCode=!1,o.countdown=60,e.p=2,e.n=3,(0,M.UA)({phone:o.phone.trim()});case 3:(0,F.y)("验证码已发送，请注意查收"),r=setInterval(function(){o.countdown--,o.countdown<=0&&(clearInterval(r),o.canSendCode=!0)},1e3),e.n=5;break;case 4:e.p=4,e.v,(0,F.y)("发送失败，请重试"),o.canSendCode=!0,o.countdown=0;case 5:return e.a(2)}},e,null,[[2,4]])})),b.apply(this,arguments)}function m(){return f.apply(this,arguments)}function f(){return f=(0,y.A)((0,L.A)().m(function n(){var u,t,s,l;return(0,L.A)().w(function(n){while(1)switch(n.p=n.n){case 0:if(u=a(),t=i(),s=c(),u&&t&&s){n.n=1;break}return(0,F.y)("请填写真实的信息"),n.a(2);case 1:if(o.selectedSubject){n.n=2;break}return(0,F.y)("请选择您的学科"),n.a(2);case 2:return o.isLoading=!0,n.p=3,n.n=4,r.dispatch("user/login",{userName:o.userName.trim(),jobNumber:o.jobNumber.trim(),phone:o.phone.trim(),subject:o.selectedSubject});case 4:e.push({path:"/home",query:{userName:o.userName.trim(),jobNumber:o.jobNumber.trim(),subject:o.selectedSubject,userId:r.state.user.userId||0}}),n.n=6;break;case 5:n.p=5,l=n.v,(0,F.y)(l||"登录失败，请稍后再试");case 6:return n.p=6,o.isLoading=!1,n.f(6);case 7:return n.a(2)}},n,null,[[3,5,6,7]])})),f.apply(this,arguments)}return(0,u.sV)(function(){t()}),(0,j.A)((0,j.A)({},(0,C.QW)(o)),{},{isFormValid:n,handleLogin:m,handleSendCode:p,validateUserName:a,validateJobNumber:i,validatePhone:c,validateVerifyCode:l})}};var x=o(71241);const I=(0,x.A)(A,[["render",g],["__scopeId","data-v-28291c84"]]),U=I}}]);