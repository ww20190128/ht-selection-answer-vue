"use strict";(self["webpackChunkxlzx"]=self["webpackChunkxlzx"]||[]).push([[170],{54170:(e,r,n)=>{n.r(r),n.d(r,{default:()=>P});var o=n(56768),u=n(45130),t=n(24232),s=function(e){return(0,o.Qi)("data-v-724fa658"),e=e(),(0,o.jt)(),e},a={class:"login-wrap"},c={class:"login-container"},i=s((function(){return(0,o.Lk)("div",{class:"logo-area"},[(0,o.Lk)("div",{class:"logo-icon"},[(0,o.Lk)("i",{class:"fa fa-graduation-cap"})]),(0,o.Lk)("h2",null,"请用企微真实信息-登录")],-1)})),l={class:"form-group"},d=s((function(){return(0,o.Lk)("i",{class:"fa fa-user"},null,-1)})),p={key:0,class:"error-text"},b={class:"form-group"},f=s((function(){return(0,o.Lk)("i",{class:"fa fa-id-card"},null,-1)})),m={key:0,class:"error-text"},v={class:"form-group"},h={class:"input-with-btn"},N=s((function(){return(0,o.Lk)("i",{class:"fa fa-phone"},null,-1)})),k={key:0,class:"error-text"},E={class:"form-group"},g=s((function(){return(0,o.Lk)("i",{class:"fa fa-book"},null,-1)})),L=s((function(){return(0,o.Lk)("option",{value:"",disabled:"",selected:""},"请选择您所属的学科",-1)})),j=["value"],y=s((function(){return(0,o.Lk)("div",{class:"select-arrow"},[(0,o.Lk)("i",{class:"fa fa-chevron-down"})],-1)})),C=["disabled"],w={key:0},x={key:1},F=s((function(){return(0,o.Lk)("i",{class:"fa fa-spinner fa-spin"},null,-1)})),M=s((function(){return(0,o.Lk)("div",{class:"footer-text"},[(0,o.Lk)("p",{class:"action"},"© 2025 师资风采大赛-题目投票系统"),(0,o.Lk)("p",{class:"action"}," 为确保投票的公平，请用真实个人信息投票，非真实信息投票无效！ "),(0,o.Lk)("p",{class:"action"}," 系统使用过程中如有疑问请企微联系：基础研究总院-王伟 ")],-1)}));function S(e,r,n,s,S,A){return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("div",c,[i,(0,o.Lk)("form",{class:"form-content",onSubmit:r[20]||(r[20]=(0,u.D$)((function(){return s.handleLogin&&s.handleLogin.apply(s,arguments)}),["prevent"]))},[(0,o.Lk)("div",l,[(0,o.Lk)("div",{class:(0,t.C4)(["input-wrapper",{focused:e.userNameFocused,error:e.userNameError}])},[d,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"userName","onUpdate:modelValue":r[0]||(r[0]=function(r){return e.userName=r}),placeholder:"您的真实姓名",required:"",onFocus:r[1]||(r[1]=function(r){return e.userNameFocused=!0}),onBlur:r[2]||(r[2]=function(r){e.userNameFocused=!1,s.validateUserName()}),onInput:r[3]||(r[3]=function(e){return s.validateUserName()})},null,544),[[u.Jo,e.userName]])],2),e.userNameError?((0,o.uX)(),(0,o.CE)("p",p,(0,t.v_)(e.userNameErrorMsg),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",b,[(0,o.Lk)("div",{class:(0,t.C4)(["input-wrapper",{focused:e.jobNumberFocused,error:e.jobNumberError}])},[f,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"jobNumber","onUpdate:modelValue":r[4]||(r[4]=function(r){return e.jobNumber=r}),placeholder:"企微工号，6位数字，如085796",required:"",onFocus:r[5]||(r[5]=function(r){return e.jobNumberFocused=!0}),onBlur:r[6]||(r[6]=function(r){e.jobNumberFocused=!1,s.validateJobNumber()}),onInput:r[7]||(r[7]=function(e){return s.validateJobNumber()}),minlength:"6",maxlength:"6"},null,544),[[u.Jo,e.jobNumber]])],2),e.jobNumberError?((0,o.uX)(),(0,o.CE)("p",m,(0,t.v_)(e.jobNumberErrorMsg),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",v,[(0,o.Lk)("div",h,[(0,o.Lk)("div",{class:(0,t.C4)(["input-wrapper",{focused:e.phoneFocused,error:e.phoneError}])},[N,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":r[8]||(r[8]=function(r){return e.phone=r}),placeholder:"企微绑定的手机号",required:"",onFocus:r[9]||(r[9]=function(r){return e.phoneFocused=!0}),onBlur:r[10]||(r[10]=function(r){e.phoneFocused=!1,s.validatePhone()}),onInput:r[11]||(r[11]=function(e){return s.validatePhone()}),maxlength:"11"},null,544),[[u.Jo,e.phone]])],2)]),e.phoneError?((0,o.uX)(),(0,o.CE)("p",k,(0,t.v_)(e.phoneErrorMsg),1)):(0,o.Q3)("",!0)]),(0,o.Q3)("",!0),(0,o.Lk)("div",E,[(0,o.Lk)("div",{class:(0,t.C4)(["select-wrapper",{focused:e.isSelectFocused}])},[g,(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":r[16]||(r[16]=function(r){return e.selectedSubject=r}),id:"subject",required:"",onFocus:r[17]||(r[17]=function(r){return e.isSelectFocused=!0}),onBlur:r[18]||(r[18]=function(r){return e.isSelectFocused=!1})},[L,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.subjects,(function(e){return(0,o.uX)(),(0,o.CE)("option",{value:e.id,key:e.id},(0,t.v_)(e.title),9,j)})),128))],544),[[u.u1,e.selectedSubject]]),y],2)]),(0,o.Lk)("button",{class:"login-btn",onClick:r[19]||(r[19]=function(){return s.handleLogin&&s.handleLogin.apply(s,arguments)}),disabled:e.isLoading},[e.isLoading?((0,o.uX)(),(0,o.CE)("span",x,[F,(0,o.eW)(" 登录中...")])):((0,o.uX)(),(0,o.CE)("span",w,"登录"))],8,C)],32),M])])}var A=n(14048),I=n(41034),U=n(30388),X=(n(44114),n(2892),n(27495),n(90906),n(42762),n(76031),n(90144)),V=n(81387),J=n(80791),Q=n(77726),$=n(80057);const _={name:"Login",setup:function(){var e=(0,V.rd)(),r=(0,$.Pj)(),n=(0,X.Kh)({userName:"",jobNumber:"",phone:"",verifyCode:"110000",selectedSubject:"",subjects:[],isLoading:!1,isSelectFocused:!1,userNameFocused:!1,jobNumberFocused:!1,phoneFocused:!1,verifyCodeFocused:!1,userNameError:!1,userNameErrorMsg:"",jobNumberError:!1,jobNumberErrorMsg:"",phoneError:!1,phoneErrorMsg:"",verifyCodeError:!0,verifyCodeErrorMsg:"",countdown:0,canSendCode:!0}),u=(0,X.KR)(!1);function t(){return s.apply(this,arguments)}function s(){return s=(0,U.A)((0,A.A)().mark((function e(){var r,o;return(0,A.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Q.u7)();case 3:r=e.sent,o=r.knowledgeTreeList,n.subjects=o||[],e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),(0,J.y)("获取学科列表失败，请刷新页面重试");case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),s.apply(this,arguments)}function a(){var e=n.userName.trim(),r=/^[\u4e00-\u9fa5·]{2,10}$/,o=/^·|·$|·{2,}/;return e&&(!r.test(e)||o.test(e))?(n.userNameError=!0,n.userNameErrorMsg="请输入2~10个汉字的真实姓名",d(),!1):(n.userNameError=!1,n.userNameErrorMsg="",d(),!0)}function c(){var e=n.jobNumber.trim(),r=/^\d{6}$/;return e?r.test(e)?Number(e)>9e4?(n.jobNumberError=!0,n.jobNumberErrorMsg="整输入正确的工号",d(),!1):(n.jobNumberError=!1,n.jobNumberErrorMsg="",d(),!0):(n.jobNumberError=!0,n.jobNumberErrorMsg="工号必须为0开头的6位数字",d(),!1):(n.jobNumberError=!1,n.jobNumberErrorMsg="",d(),!0)}function i(){var e=n.phone.trim(),r=/^1\d{10}$/;return e?r.test(e)?(n.phoneError=!1,n.phoneErrorMsg="",d(),!0):(n.phoneError=!0,n.phoneErrorMsg="请输入正确的11位手机号",d(),!1):(n.phoneError=!1,n.phoneErrorMsg="",d(),!0)}function l(){var e=n.verifyCode.trim(),r=/^\d{6}$/;return e?r.test(e)?(n.verifyCodeError=!1,n.verifyCodeErrorMsg="",d(),!0):(n.verifyCodeError=!0,n.verifyCodeErrorMsg="验证码必须为6位数字",d(),!1):(n.verifyCodeError=!1,n.verifyCodeErrorMsg="",d(),!0)}function d(){u.value=!n.userNameError&&!n.jobNumberError&&!n.phoneError&&n.userName.trim()&&n.jobNumber.trim()&&n.phone.trim()&&n.selectedSubject}function p(){return b.apply(this,arguments)}function b(){return b=(0,U.A)((0,A.A)().mark((function e(){var r;return(0,A.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i()&&!n.phoneError){e.next=3;break}return(0,J.y)("请输入正确的手机号"),e.abrupt("return");case 3:return n.canSendCode=!1,n.countdown=60,e.prev=5,e.next=8,(0,Q.UA)({phone:n.phone.trim()});case 8:(0,J.y)("验证码已发送，请注意查收"),r=setInterval((function(){n.countdown--,n.countdown<=0&&(clearInterval(r),n.canSendCode=!0)}),1e3),e.next=17;break;case 12:e.prev=12,e.t0=e["catch"](5),(0,J.y)("发送失败，请重试"),n.canSendCode=!0,n.countdown=0;case 17:case"end":return e.stop()}}),e,null,[[5,12]])}))),b.apply(this,arguments)}function f(){return m.apply(this,arguments)}function m(){return m=(0,U.A)((0,A.A)().mark((function o(){var u,t,s;return(0,A.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(u=a(),t=c(),s=i(),u&&t&&s){o.next=6;break}return(0,J.y)("请填写真实的信息"),o.abrupt("return");case 6:if(n.selectedSubject){o.next=9;break}return(0,J.y)("请选择您的学科"),o.abrupt("return");case 9:return n.isLoading=!0,o.prev=10,o.next=13,r.dispatch("user/login",{userName:n.userName.trim(),jobNumber:n.jobNumber.trim(),phone:n.phone.trim(),subject:n.selectedSubject});case 13:e.push({path:"/home",query:{userName:n.userName.trim(),jobNumber:n.jobNumber.trim(),subject:n.selectedSubject,userId:r.state.user.userId||0}}),o.next=19;break;case 16:o.prev=16,o.t0=o["catch"](10),(0,J.y)(o.t0||"登录失败，请稍后再试");case 19:return o.prev=19,n.isLoading=!1,o.finish(19);case 22:case"end":return o.stop()}}),o,null,[[10,16,19,22]])}))),m.apply(this,arguments)}return(0,o.sV)((function(){t()})),(0,I.A)((0,I.A)({},(0,X.QW)(n)),{},{isFormValid:u,handleLogin:f,handleSendCode:p,validateUserName:a,validateJobNumber:c,validatePhone:i,validateVerifyCode:l})}};var q=n(71241);const B=(0,q.A)(_,[["render",S],["__scopeId","data-v-724fa658"]]),P=B}}]);